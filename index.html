<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Li-Fi Screen Sender</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #111;
        color: white;
        text-align: center;
        padding-top: 40px;
    }

    #screenFlash {
        position: fixed;
        top: 0; left: 0;
        width: 100vw;
        height: 100vh;
        background: black;
        z-index: -1;
        transition: background 0.05s linear;
    }

    input, button {
        font-size: 18px;
        padding: 10px;
        width: 80%;
        max-width: 350px;
        margin-top: 10px;
    }

    #status {
        margin-top: 20px;
        font-size: 20px;
        color: #0f0;
    }
</style>
</head>
<body>

<h1>ðŸ’¡ Li-Fi Screen Sender</h1>

<input id="msgInput" type="text" placeholder="Type your message here..." />
<br>
<button onclick="startSending()">Send Message</button>

<div id="status">Idle...</div>

<div id="screenFlash"></div>

<script>
const bitTime = 200; // 200ms per bit

function charToBinary(char) {
    return char.charCodeAt(0).toString(2).padStart(8, "0");
}

function setFlash(on) {
    document.getElementById("screenFlash").style.background = on ? "white" : "black";
}

function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

async function sendBit(bit) {
    setFlash(bit === "1");
    await sleep(bitTime);
}

async function startSending() {
    const msg = document.getElementById("msgInput").value;
    const status = document.getElementById("status");

    if (!msg) {
        alert("Enter a message first!");
        return;
    }

    status.innerText = "Sending...";

    // START BIT = 1
    await sendBit("1");
    await sendBit("0"); // small gap

    // SEND CHARACTERS
    for (let i = 0; i < msg.length; i++) {
        let bin = charToBinary(msg[i]);
        console.log("Sending:", msg[i], bin);

        for (let b of bin) {
            await sendBit(b);
        }
    }

    // STOP BYTE = 00000000
    for (let i = 0; i < 8; i++) {
        await sendBit("0");
    }

    status.innerText = "Done!";
    setFlash(false);
}
</script>

</body>
</html>
